<div class="app-container max-w-2xl mx-auto p-4">
  <div class="menu-wrapper bg-white rounded-2xl p-6 shadow-sm border border-slate-100">

    <!-- Home Screen -->
    <div *ngIf="currentScreen() === 'home'" class="screen active">

      <!-- Menu Header -->
      <div class="menu-header text-center mb-8">
        <h1 class="text-2xl font-bold mb-2">Master Business Lingo</h1>
        <p class="text-slate-500 text-sm">Welcome back! Ready to learn?</p>
      </div>

      <!-- Continue Learning - Primary CTA -->
      <button
        *ngIf="lastSession()"
        (click)="continueLearning()"
        class="continue-action w-full bg-blue-600 text-white border-none py-4 px-6 rounded-lg font-semibold text-lg flex items-center justify-between mb-4 shadow-md hover:shadow-lg transition-all"
        [disabled]="isLoading">
        <div class="continue-left flex items-center gap-3">
          <span class="continue-icon text-xl">‚ñ∂Ô∏è</span>
          <div class="continue-text text-left">
            <span class="continue-title block text-lg font-semibold">Continue Learning</span>
            <span class="continue-subtitle block text-sm opacity-85">
              {{ getCategoryName(lastSession()?.category ?? null) }} ‚Ä¢ {{ lastSession()?.gameMode === 'classic' ? 'Classic' : 'Blitz' }} ‚Ä¢ Level {{ lastSession()?.difficulty || 'All' }}
            </span>
          </div>
        </div>
        <span class="continue-arrow text-xl opacity-80">‚Üí</span>
      </button>

      <!-- Separator -->
      <div class="separator text-center mb-6 relative">
        <div class="absolute inset-0 flex items-center">
          <div class="w-full border-t border-slate-200"></div>
        </div>
        <div class="relative bg-white px-4">
          <span class="text-sm text-slate-500 font-medium uppercase tracking-wide">or choose</span>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="quick-actions grid grid-cols-2 gap-3 mb-6">
        <button
          (click)="quickStartNew('hr')"
          class="quick-action bg-slate-50 border-2 border-slate-200 rounded-lg p-4 text-center transition-all hover:border-blue-500 hover:shadow-md disabled:opacity-50"
          [disabled]="isLoading">
          <div class="quick-action-icon text-3xl mb-2">üéØ</div>
          <div class="quick-action-title font-semibold text-sm">New Words</div>
        </button>
        <button
          (click)="quickStartPracticeFromHome('hr')"
          class="quick-action bg-slate-50 border-2 border-slate-200 rounded-lg p-4 text-center transition-all hover:border-blue-500 hover:shadow-md disabled:opacity-50"
          [disabled]="isLoading || getCategoryStats('hr').needsPractice === 0">
          <div class="quick-action-icon text-3xl mb-2">‚ö†Ô∏è</div>
          <div class="quick-action-title font-semibold text-sm">Practice Mistakes</div>
        </button>
      </div>

      <!-- Categories -->
      <div class="categories-section mb-6">
        <div class="categories-label text-xs font-semibold uppercase tracking-wide text-slate-500 mb-3">Or choose a category</div>
        <div class="categories-grid grid grid-cols-1 sm:grid-cols-2 gap-4">
          @for (category of categoryStats(); track category.id) {
            <button
              (click)="selectCategory(category.id)"
              class="category-card bg-white border-2 border-slate-200 rounded-lg p-5 text-center transition-all hover:border-blue-500 hover:shadow-md hover:-translate-y-1"
              [disabled]="isLoading">
              <div class="category-icon w-12 h-12 mx-auto mb-3 rounded-lg flex items-center justify-center text-2xl"
                   [class]="category.id === 'hr' ? 'bg-purple-50' : 'bg-blue-50'">
                {{ category.icon }}
              </div>
              <h3 class="text-lg font-semibold mb-3">{{ category.name }}</h3>

              <!-- Progress Bar -->
              <div class="progress-bar w-full h-2 bg-slate-100 rounded-full overflow-hidden mb-3">
                <div class="progress-fill h-full bg-blue-500 transition-all duration-300"
                     [style.width.%]="getProgressPercentage(category)"></div>
              </div>

              <!-- Stats -->
              <div class="category-stats flex gap-2 justify-center mb-3 flex-wrap">
                <span *ngIf="category.needsPractice > 0" class="stat-item text-xs px-2 py-1 bg-orange-50 rounded text-orange-700">‚ö†Ô∏è {{ category.needsPractice }} mistakes</span>
                <span *ngIf="category.mastered > 0" class="stat-item text-xs px-2 py-1 bg-green-50 rounded text-green-700">üéØ {{ category.mastered }} new</span>
              </div>

              <div class="category-meta text-xs text-slate-500">
                {{ category.totalLearned }} mastered
              </div>
            </button>
          }
        </div>
      </div>
    </div>

    <!-- Config Screen -->
    <div *ngIf="currentScreen() === 'config'" class="screen active">

      <!-- Config Header -->
      <div class="config-header flex items-center gap-3 mb-6">
        <button (click)="backToHome()" class="back-button w-9 h-9 bg-slate-100 border border-slate-200 rounded-lg flex items-center justify-center text-lg transition-all hover:bg-slate-200">
          ‚Üê
        </button>
        <div class="config-title flex-1">
          <h2 class="text-xl font-bold">{{ getCategoryName(selectedCategory()) }}</h2>
          <p class="text-sm text-slate-500">Customize session settings</p>
        </div>
      </div>

      <!-- Mode Selection -->
      <div class="config-section mb-6">
        <div class="section-title text-xs font-semibold uppercase tracking-wide text-slate-500 mb-3">Game Mode</div>
        <div class="option-group flex flex-col gap-2">
          <input type="radio" id="mode-classic" name="gameMode" value="classic" class="option hidden" [checked]="selectedGameMode() === 'classic'" (change)="selectedGameMode.set('classic')">
          <label for="mode-classic" class="option-label flex items-center gap-3 p-3 border-2 border-slate-200 rounded-lg cursor-pointer transition-all"
                 [class]="selectedGameMode() === 'classic' ? 'border-blue-500 bg-blue-50' : 'hover:border-blue-500'">
            <span class="option-icon text-xl w-6 text-center">üéÆ</span>
            <div class="option-content flex-1">
              <span class="option-name block font-semibold text-sm">Classic Mode</span>
              <span class="option-description block text-xs text-slate-500">Flashcards ‚Ä¢ Learn at your own pace</span>
            </div>
          </label>

          <input type="radio" id="mode-blitz" name="gameMode" value="blitz" class="option hidden" [checked]="selectedGameMode() === 'blitz'" (change)="selectedGameMode.set('blitz')">
          <label for="mode-blitz" class="option-label flex items-center gap-3 p-3 border-2 border-slate-200 rounded-lg cursor-pointer transition-all"
                 [class]="selectedGameMode() === 'blitz' ? 'border-blue-500 bg-blue-50' : 'hover:border-blue-500'">
            <span class="option-icon text-xl w-6 text-center">‚ö°</span>
            <div class="option-content flex-1">
              <span class="option-name block font-semibold text-sm">Blitz Mode</span>
              <span class="option-description block text-xs text-slate-500">Type answers ‚Ä¢ Race against time</span>
            </div>
          </label>
        </div>
      </div>

      <!-- Difficulty Selection -->
      <div class="config-section mb-6">
        <div class="section-title text-xs font-semibold uppercase tracking-wide text-slate-500 mb-3">Difficulty Level</div>
        <div class="difficulty-grid grid grid-cols-3 gap-2 mb-2">
          <button (click)="selectedDifficulty.set(1)" class="difficulty-btn p-3 border-2 border-slate-200 bg-white rounded-lg text-center transition-all hover:border-blue-500"
                  [class]="selectedDifficulty() === 1 ? 'border-blue-500 bg-blue-50' : ''">
            <div class="difficulty-number text-lg font-bold">1</div>
            <div class="difficulty-label text-xs text-slate-500">Beginner</div>
          </button>
          <button (click)="selectedDifficulty.set(2)" class="difficulty-btn p-3 border-2 border-slate-200 bg-white rounded-lg text-center transition-all hover:border-blue-500"
                  [class]="selectedDifficulty() === 2 ? 'border-blue-500 bg-blue-50' : ''">
            <div class="difficulty-number text-lg font-bold">2</div>
            <div class="difficulty-label text-xs text-slate-500">Intermediate</div>
          </button>
          <button (click)="selectedDifficulty.set(3)" class="difficulty-btn p-3 border-2 border-slate-200 bg-white rounded-lg text-center transition-all hover:border-blue-500"
                  [class]="selectedDifficulty() === 3 ? 'border-blue-500 bg-blue-50' : ''">
            <div class="difficulty-number text-lg font-bold">3</div>
            <div class="difficulty-label text-xs text-slate-500">Advanced</div>
          </button>
        </div>
        <button (click)="selectedDifficulty.set(null)" class="difficulty-all p-3 border-2 border-slate-200 bg-white rounded-lg text-center font-semibold transition-all hover:border-blue-500"
                [class]="selectedDifficulty() === null ? 'border-blue-500 bg-blue-50' : ''">
          üìö All Levels
        </button>
      </div>

      <!-- Practice Type -->
      <div class="config-section mb-8">
        <div class="section-title text-xs font-semibold uppercase tracking-wide text-slate-500 mb-3">What do you want to practice?</div>
        <div class="option-group flex flex-col gap-2">
          <input type="radio" id="practice-new" name="practiceMode" value="new" class="option hidden" [checked]="selectedPracticeMode() === GameMode.New" (change)="selectedPracticeMode.set(GameMode.New)">
          <label for="practice-new" class="option-label flex items-center gap-3 p-3 border-2 border-slate-200 rounded-lg cursor-pointer transition-all"
                 [class]="selectedPracticeMode() === GameMode.New ? 'border-blue-500 bg-blue-50' : 'hover:border-blue-500'">
            <span class="option-icon text-xl w-6 text-center">üéØ</span>
            <div class="option-content flex-1">
              <span class="option-name block font-semibold text-sm">New Words</span>
            </div>
          </label>

          <input type="radio" id="practice-mistakes" name="practiceMode" value="practice" class="option hidden" [checked]="selectedPracticeMode() === GameMode.Practice" (change)="selectedPracticeMode.set(GameMode.Practice)">
          <label for="practice-mistakes" class="option-label flex items-center gap-3 p-3 border-2 border-slate-200 rounded-lg cursor-pointer transition-all"
                 [class]="selectedPracticeMode() === GameMode.Practice ? 'border-blue-500 bg-blue-50' : 'hover:border-blue-500'"
                 [class.opacity-50]="getMistakesCount(selectedCategory()) === 0">
            <span class="option-icon text-xl w-6 text-center">‚ö†Ô∏è</span>
            <div class="option-content flex-1">
              <span class="option-name block font-semibold text-sm">Practice Mistakes</span>
            </div>
          </label>
        </div>
      </div>

      <button (click)="startSession()" class="start-button w-full py-4 bg-blue-600 text-white border-none rounded-lg text-base font-semibold transition-all hover:bg-blue-700 hover:shadow-md disabled:opacity-50"
              [disabled]="isLoading">
        Start Session üöÄ
      </button>
    </div>
  </div>
</div>
